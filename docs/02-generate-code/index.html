<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="ie=edge">
<title>2. Generate codes - sample controller</title>
<meta name=viewport content="width=device-width,initial-scale=1">
<link rel=icon href=https://about.nakamasato.com/sample-controller/favicon.png>
<link rel=stylesheet href=/sample-controller/css/style.min.6719d72e323121369d5caeb4264b95d8a63cf1deaab029da67602fe5a046e0a4.css>
</head>
<body class="page page-default-single">
<div id=main-menu-mobile class=main-menu-mobile>
<ul>
<li class=menu-item-home>
<a href=/sample-controller/>
<span>Home</span>
</a>
</li>
<li class=menu-item-docs>
<a href=/sample-controller/docs/>
<span>Docs</span>
</a>
</li>
</ul>
</div>
<div class=wrapper>
<div class=header>
<div class=container>
<div class=logo>
<a href=https://about.nakamasato.com/sample-controller><img alt=Logo src=/sample-controller/images/logo.svg></a>
</div>
<div class=logo-mobile>
<a href=https://about.nakamasato.com/sample-controller><img alt=Logo src=/sample-controller/images/logo-mobile.svg></a>
</div>
<div id=main-menu class=main-menu>
<ul>
<li class=menu-item-home>
<a href=/sample-controller/>
<span>Home</span>
</a>
</li>
<li class=menu-item-docs>
<a href=/sample-controller/docs/>
<span>Docs</span>
</a>
</li>
</ul>
</div>
<button id=toggle-main-menu-mobile class="hamburger hamburger--slider" type=button>
<span class=hamburger-box>
<span class=hamburger-inner></span>
</span>
</button>
</div>
</div>
<div class="container pt-2 pt-md-6 pb-3 pb-md-6">
<div class=row>
<div class="col-12 col-md-3 mb-3">
<div class=sidebar>
<div class=docs-menu>
<h4>Docs</h4>
<ul>
<li>
<a href=https://about.nakamasato.com/sample-controller/docs/00-init-module/>0. Install Go module</a>
</li>
<li>
<a href=https://about.nakamasato.com/sample-controller/docs/01-define-crd/>1. Define CRD</a>
</li>
<li class=active>
<a href=https://about.nakamasato.com/sample-controller/docs/02-generate-code/>2. Generate codes</a>
</li>
<li>
<a href=https://about.nakamasato.com/sample-controller/docs/03-create-crd-yaml/>3. Create CRD yaml file</a>
</li>
</ul>
</div>
</div>
</div>
<div class="col-12 col-md-9">
<h1 class=title>2. Generate codes</h1>
<div class=content>
<h2 id=2-generate-code>2. Generate code</h2>
<ol>
<li>
<p>Set <code>execDir</code> env var for <code>code-generator</code>.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>execDir=~/repos/kubernetes/code-generator
</code></pre></div><p>If you already cloned, you can specify the directory.</p>
</li>
<li>
<p>Clone code-generator if you haven&rsquo;t cloned.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>git clone https://github.com/kubernetes/code-generator.git $execDir
</code></pre></div>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=s>&#34;${execDir}&#34;</span><span class=o>/</span><span class=nx>generate</span><span class=o>-</span><span class=nx>groups</span><span class=p>.</span><span class=nx>sh</span>
<span class=nx>Usage</span><span class=p>:</span> <span class=nx>generate</span><span class=o>-</span><span class=nx>groups</span><span class=p>.</span><span class=nx>sh</span> <span class=p>&lt;</span><span class=nx>generators</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nx>output</span><span class=o>-</span><span class=kn>package</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nx>apis</span><span class=o>-</span><span class=kn>package</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nx>groups</span><span class=o>-</span><span class=nx>versions</span><span class=p>&gt;</span> <span class=o>...</span>

  <span class=p>&lt;</span><span class=nx>generators</span><span class=p>&gt;</span>        <span class=nx>the</span> <span class=nx>generators</span> <span class=nx>comma</span> <span class=nx>separated</span> <span class=nx>to</span> <span class=nf>run</span> <span class=p>(</span><span class=nx>deepcopy</span><span class=p>,</span><span class=nx>defaulter</span><span class=p>,</span><span class=nx>client</span><span class=p>,</span><span class=nx>lister</span><span class=p>,</span><span class=nx>informer</span><span class=p>)</span> <span class=nx>or</span> <span class=s>&#34;all&#34;</span><span class=p>.</span>
  <span class=p>&lt;</span><span class=nx>output</span><span class=o>-</span><span class=kn>package</span><span class=p>&gt;</span>    <span class=nx>the</span> <span class=nx>output</span> <span class=kn>package</span> <span class=nf>name</span> <span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>g</span><span class=p>.</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>example</span><span class=o>/</span><span class=nx>project</span><span class=o>/</span><span class=nx>pkg</span><span class=o>/</span><span class=nx>generated</span><span class=p>).</span>
  <span class=p>&lt;</span><span class=nx>apis</span><span class=o>-</span><span class=kn>package</span><span class=p>&gt;</span>      <span class=nx>the</span> <span class=nx>external</span> <span class=nx>types</span> <span class=nf>dir</span> <span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>g</span><span class=p>.</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>example</span><span class=o>/</span><span class=nx>api</span> <span class=nx>or</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>example</span><span class=o>/</span><span class=nx>project</span><span class=o>/</span><span class=nx>pkg</span><span class=o>/</span><span class=nx>apis</span><span class=p>).</span>
  <span class=p>&lt;</span><span class=nx>groups</span><span class=o>-</span><span class=nx>versions</span><span class=p>&gt;</span>   <span class=nx>the</span> <span class=nx>groups</span> <span class=nx>and</span> <span class=nx>their</span> <span class=nx>versions</span> <span class=nx>in</span> <span class=nx>the</span> <span class=nx>format</span> <span class=s>&#34;groupA:v1,v2 groupB:v1 groupC:v2&#34;</span><span class=p>,</span> <span class=nx>relative</span>
                      <span class=nx>to</span> <span class=p>&lt;</span><span class=nx>api</span><span class=o>-</span><span class=kn>package</span><span class=p>&gt;.</span>
  <span class=o>...</span>                 <span class=nx>arbitrary</span> <span class=nx>flags</span> <span class=nx>passed</span> <span class=nx>to</span> <span class=nx>all</span> <span class=nx>generator</span> <span class=nx>binaries</span><span class=p>.</span>


<span class=nx>Examples</span><span class=p>:</span>
  <span class=nx>generate</span><span class=o>-</span><span class=nx>groups</span><span class=p>.</span><span class=nx>sh</span> <span class=nx>all</span>             <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>example</span><span class=o>/</span><span class=nx>project</span><span class=o>/</span><span class=nx>pkg</span><span class=o>/</span><span class=nx>client</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>example</span><span class=o>/</span><span class=nx>project</span><span class=o>/</span><span class=nx>pkg</span><span class=o>/</span><span class=nx>apis</span> <span class=s>&#34;foo:v1 bar:v1alpha1,v1beta1&#34;</span>
  <span class=nx>generate</span><span class=o>-</span><span class=nx>groups</span><span class=p>.</span><span class=nx>sh</span> <span class=nx>deepcopy</span><span class=p>,</span><span class=nx>client</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>example</span><span class=o>/</span><span class=nx>project</span><span class=o>/</span><span class=nx>pkg</span><span class=o>/</span><span class=nx>client</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>example</span><span class=o>/</span><span class=nx>project</span><span class=o>/</span><span class=nx>pkg</span><span class=o>/</span><span class=nx>apis</span> <span class=s>&#34;foo:v1 bar:v1alpha1,v1beta1&#34;</span>
</code></pre></div>
</li>
<li>
<p>Generate codes (deepcopy, clientset, listers, and informers).</p>
<p>※ You need to replace <code>github.com/nakamasato/sample-controller</code> with your package name.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>&#34;${execDir}&#34;/generate-groups.sh all github.com/nakamasato/sample-controller/pkg/client github.com/nakamasato/sample-controller/pkg/apis example.com:v1alpha1 --go-header-file &#34;${execDir}&#34;/hack/boilerplate.go.txt
</code></pre></div>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>tree .
.
├── README.md
├── go.mod
├── go.sum
└── pkg
    ├── apis
    │   └── example.com
    │       └── v1alpha1
    │           ├── doc.go
    │           ├── register.go
    │           ├── types.go
    │           └── zz_generated.deepcopy.go
    └── client
        ├── clientset
        │   └── versioned
        │       ├── clientset.go
        │       ├── doc.go
        │       ├── fake
        │       │   ├── clientset_generated.go
        │       │   ├── doc.go
        │       │   └── register.go
        │       ├── scheme
        │       │   ├── doc.go
        │       │   └── register.go
        │       └── typed
        │           └── example.com
        │               └── v1alpha1
        │                   ├── doc.go
        │                   ├── example.com_client.go
        │                   ├── fake
        │                   │   ├── doc.go
        │                   │   ├── fake_example.com_client.go
        │                   │   └── fake_foo.go
        │                   ├── foo.go
        │                   └── generated_expansion.go
        ├── informers
        │   └── externalversions
        │       ├── example.com
        │       │   ├── interface.go
        │       │   └── v1alpha1
        │       │       ├── foo.go
        │       │       └── interface.go
        │       ├── factory.go
        │       ├── generic.go
        │       └── internalinterfaces
        │           └── factory_interfaces.go
        └── listers
            └── example.com
                └── v1alpha1
                    ├── expansion_generated.go
                    └── foo.go

21 directories, 29 files
</code></pre></div>
</li>
<li>
<p>Run <code>go mod tidy</code>.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=sub-footer>
<div class=container>
<div class=row>
<div class=col-12>
<div class=sub-footer-inner>
<ul>
<li class=zerostatic><a href=https://www.zerostatic.io>www.zerostatic.io</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<script type=text/javascript src=/sample-controller/js/scripts.min.eaf147370baecdd07c022597db631f99cab1c9cd6479de586f30327a568d6a0f.js></script>
</body>
</html>